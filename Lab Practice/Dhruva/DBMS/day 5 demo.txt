Enter password: *******
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 21
Server version: 8.0.22 MySQL Community Server - GPL

Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> use iacsd0324_dbda
Database changed
mysql> show indexes on emp;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'on emp' at line 1
mysql> show indexes emp;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'emp' at line 1
mysql> show indexes from emp;
+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| Table | Non_unique | Key_name | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | Visible | Expression |
+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| emp   |          0 | PRIMARY  |            1 | EMPNO       | A         |          21 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
1 row in set (0.09 sec)

mysql> create index idx_sal
    -> on emp(sal);
Query OK, 0 rows affected (0.10 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> show indexes from emp;
+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| Table | Non_unique | Key_name | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | Visible | Expression |
+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| emp   |          0 | PRIMARY  |            1 | EMPNO       | A         |          21 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| emp   |          1 | idx_sal  |            1 | SAL         | A         |          16 |     NULL |   NULL | YES  | BTREE      |         |               | YES     | NULL       |
+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
2 rows in set (0.05 sec)

mysql> explain select * from emp
    -> where sal>2000;
+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+
| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |
+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+
|  1 | SIMPLE      | emp   | NULL       | ALL  | idx_sal       | NULL | NULL    | NULL |   21 |    66.67 | Using where |
+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+
1 row in set, 1 warning (0.05 sec)

mysql> select * from emp where sal >2000;
+-------+----------+-----------+------+------------+----------+---------+--------+
| EMPNO | ENAME    | JOB       | MGR  | HIREDATE   | SAL      | COMM    | DEPTNO |
+-------+----------+-----------+------+------------+----------+---------+--------+
|   100 | Rajat_k  | CLERK     | 7902 | 1982-03-04 | 45678.00 | 3456.00 |     10 |
|   101 | Ashwin   | manager   | NULL | 2020-01-01 | 34566.00 | 3456.00 |     10 |
|   102 | Ashwini  | CLERK     | 7902 | 2020-01-01 | 34566.00 | 3456.00 |     10 |
|   103 | Deepa    | CLERK     | 7902 | 2022-01-01 | 34466.00 | 3456.00 |     30 |
|   104 | Sangeeta | CLERK     | 7902 | 2022-01-01 | 34466.00 | 3456.00 |     10 |
|   123 | Revati   | design    | NULL | 2020-03-12 | 45678.00 | 4567.00 |   NULL |
|   125 | Atharva  | design    | NULL | 2021-03-15 | 55678.00 | 4567.00 |   NULL |
|  7369 | SMITH    | CLERK     | 7902 | 1980-12-17 |  4975.00 |    NULL |     20 |
|  7566 | JONES    | MANAGER   | 7839 | 1981-04-02 |  2975.00 |    NULL |     20 |
|  7698 | BLAKE    | MANAGER   | 7839 | 1981-05-01 |  2850.00 |    NULL |     30 |
|  7782 | CLARK    | MANAGER   | 7839 | 1981-06-09 |  2450.00 |    NULL |     10 |
|  7788 | SCOTT    | ANALYST   | 7566 | 1982-12-09 |  3000.00 |    NULL |     20 |
|  7839 | KING     | PRESIDENT | NULL | 1981-11-17 |  5000.00 |    NULL |     10 |
|  7902 | FORD     | ANALYST   | 7566 | 1981-12-03 |  3000.00 |    NULL |     20 |
+-------+----------+-----------+------+------------+----------+---------+--------+
14 rows in set (0.00 sec)

mysql> explain select * from emp where sal >2000;
+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+
| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |
+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+
|  1 | SIMPLE      | emp   | NULL       | ALL  | idx_sal       | NULL | NULL    | NULL |   21 |    66.67 | Using where |
+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+
1 row in set, 1 warning (0.00 sec)

mysql> show engines;
+--------------------+---------+----------------------------------------------------------------+--------------+------+------------+
| Engine             | Support | Comment                                                        | Transactions | XA   | Savepoints |
+--------------------+---------+----------------------------------------------------------------+--------------+------+------------+
| MEMORY             | YES     | Hash based, stored in memory, useful for temporary tables      | NO           | NO   | NO         |
| MRG_MYISAM         | YES     | Collection of identical MyISAM tables                          | NO           | NO   | NO         |
| CSV                | YES     | CSV storage engine                                             | NO           | NO   | NO         |
| FEDERATED          | NO      | Federated MySQL storage engine                                 | NULL         | NULL | NULL       |
| PERFORMANCE_SCHEMA | YES     | Performance Schema                                             | NO           | NO   | NO         |
| MyISAM             | YES     | MyISAM storage engine                                          | NO           | NO   | NO         |
| InnoDB             | DEFAULT | Supports transactions, row-level locking, and foreign keys     | YES          | YES  | YES        |
| BLACKHOLE          | YES     | /dev/null storage engine (anything you write to it disappears) | NO           | NO   | NO         |
| ARCHIVE            | YES     | Archive storage engine                                         | NO           | NO   | NO         |
+--------------------+---------+----------------------------------------------------------------+--------------+------+------------+
9 rows in set (0.04 sec)

mysql> create table mytable
    -> (id int,name varchar(20));
Query OK, 0 rows affected (0.07 sec)

mysql> insert into mytable values(1,'xxx');
Query OK, 1 row affected (0.05 sec)

mysql> rollback;
Query OK, 0 rows affected (0.00 sec)

mysql> select * from mytable;
+------+------+
| id   | name |
+------+------+
|    1 | xxx  |
+------+------+
1 row in set (0.00 sec)

mysql> set autocommit=0;
Query OK, 0 rows affected (0.00 sec)

mysql> insert into mytable values(2,'yyy');
Query OK, 1 row affected (0.00 sec)

mysql> rollback;
Query OK, 0 rows affected (0.00 sec)

mysql> insert into mytable values(2,'yyy');
Query OK, 1 row affected (0.00 sec)

mysql> insert into mytable values(3,'zzzz');
Query OK, 1 row affected (0.00 sec)

mysql> commit;
Query OK, 0 rows affected (0.00 sec)

mysql> insert into mytable values(4,'ppp');
Query OK, 1 row affected (0.00 sec)

mysql> select * from mytable;
+------+------+
| id   | name |
+------+------+
|    1 | xxx  |
|    2 | yyy  |
|    3 | zzzz |
|    4 | ppp  |
+------+------+
4 rows in set (0.00 sec)

mysql> rollback;
Query OK, 0 rows affected (0.00 sec)

mysql> select * from mytable;
+------+------+
| id   | name |
+------+------+
|    1 | xxx  |
|    2 | yyy  |
|    3 | zzzz |
+------+------+
3 rows in set (0.00 sec)

mysql> insert into mytable values(4,'ppp');
Query OK, 1 row affected (0.00 sec)

mysql> insert into mytable values(5,'ppp');
Query OK, 1 row affected (0.00 sec)

mysql> savepoint A;
Query OK, 0 rows affected (0.05 sec)

mysql> insert into mytable values(6,'ppp');
Query OK, 1 row affected (0.00 sec)

mysql> delete from mytable where id=5;
Query OK, 1 row affected (0.00 sec)

mysql> select * from mytable;
+------+------+
| id   | name |
+------+------+
|    1 | xxx  |
|    2 | yyy  |
|    3 | zzzz |
|    4 | ppp  |
|    6 | ppp  |
+------+------+
5 rows in set (0.00 sec)

mysql> savepoint B
    -> ;
Query OK, 0 rows affected (0.00 sec)

mysql> insert into mytable values(7,'ppp');
Query OK, 1 row affected (0.00 sec)

mysql> rollback to B;
Query OK, 0 rows affected (0.00 sec)

mysql> select * from mytable;
+------+------+
| id   | name |
+------+------+
|    1 | xxx  |
|    2 | yyy  |
|    3 | zzzz |
|    4 | ppp  |
|    6 | ppp  |
+------+------+
5 rows in set (0.00 sec)

mysql> commit;
Query OK, 0 rows affected (0.00 sec)

mysql> set autocommit=1;
Query OK, 0 rows affected (0.00 sec)

mysql> select empno,ename,sal,row_number() over (order by sal desc)
    -> from emp;
+-------+----------+----------+---------------------------------------+
| empno | ename    | sal      | row_number() over (order by sal desc) |
+-------+----------+----------+---------------------------------------+
|   125 | Atharva  | 55678.00 |                                     1 |
|   100 | Rajat_k  | 45678.00 |                                     2 |
|   123 | Revati   | 45678.00 |                                     3 |
|   101 | Ashwin   | 34566.00 |                                     4 |
|   102 | Ashwini  | 34566.00 |                                     5 |
|   103 | Deepa    | 34466.00 |                                     6 |
|   104 | Sangeeta | 34466.00 |                                     7 |
|  7839 | KING     |  5000.00 |                                     8 |
|  7369 | SMITH    |  4975.00 |                                     9 |
|  7788 | SCOTT    |  3000.00 |                                    10 |
|  7902 | FORD     |  3000.00 |                                    11 |
|  7566 | JONES    |  2975.00 |                                    12 |
|  7698 | BLAKE    |  2850.00 |                                    13 |
|  7782 | CLARK    |  2450.00 |                                    14 |
|  7499 | ALLEN    |  1600.00 |                                    15 |
|  7844 | TURNER   |  1500.00 |                                    16 |
|  7934 | MILLER   |  1300.00 |                                    17 |
|  7521 | WARD     |  1250.00 |                                    18 |
|  7654 | MARTIN   |  1250.00 |                                    19 |
|  7876 | ADAMS    |  1100.00 |                                    20 |
|  7900 | JAMES    |   950.00 |                                    21 |
+-------+----------+----------+---------------------------------------+
21 rows in set (0.05 sec)

mysql> select empno,ename,sal,row_number() over (order by sal desc) rownum
    -> from emp;
+-------+----------+----------+--------+
| empno | ename    | sal      | rownum |
+-------+----------+----------+--------+
|   125 | Atharva  | 55678.00 |      1 |
|   100 | Rajat_k  | 45678.00 |      2 |
|   123 | Revati   | 45678.00 |      3 |
|   101 | Ashwin   | 34566.00 |      4 |
|   102 | Ashwini  | 34566.00 |      5 |
|   103 | Deepa    | 34466.00 |      6 |
|   104 | Sangeeta | 34466.00 |      7 |
|  7839 | KING     |  5000.00 |      8 |
|  7369 | SMITH    |  4975.00 |      9 |
|  7788 | SCOTT    |  3000.00 |     10 |
|  7902 | FORD     |  3000.00 |     11 |
|  7566 | JONES    |  2975.00 |     12 |
|  7698 | BLAKE    |  2850.00 |     13 |
|  7782 | CLARK    |  2450.00 |     14 |
|  7499 | ALLEN    |  1600.00 |     15 |
|  7844 | TURNER   |  1500.00 |     16 |
|  7934 | MILLER   |  1300.00 |     17 |
|  7521 | WARD     |  1250.00 |     18 |
|  7654 | MARTIN   |  1250.00 |     19 |
|  7876 | ADAMS    |  1100.00 |     20 |
|  7900 | JAMES    |   950.00 |     21 |
+-------+----------+----------+--------+
21 rows in set (0.00 sec)

mysql> select empno,ename,sal,row_number() over (order by sal desc),rank() over (order by sal desc) ranknum
    -> from emp;
+-------+----------+----------+---------------------------------------+---------+
| empno | ename    | sal      | row_number() over (order by sal desc) | ranknum |
+-------+----------+----------+---------------------------------------+---------+
|   125 | Atharva  | 55678.00 |                                     1 |       1 |
|   100 | Rajat_k  | 45678.00 |                                     2 |       2 |
|   123 | Revati   | 45678.00 |                                     3 |       2 |
|   101 | Ashwin   | 34566.00 |                                     4 |       4 |
|   102 | Ashwini  | 34566.00 |                                     5 |       4 |
|   103 | Deepa    | 34466.00 |                                     6 |       6 |
|   104 | Sangeeta | 34466.00 |                                     7 |       6 |
|  7839 | KING     |  5000.00 |                                     8 |       8 |
|  7369 | SMITH    |  4975.00 |                                     9 |       9 |
|  7788 | SCOTT    |  3000.00 |                                    10 |      10 |
|  7902 | FORD     |  3000.00 |                                    11 |      10 |
|  7566 | JONES    |  2975.00 |                                    12 |      12 |
|  7698 | BLAKE    |  2850.00 |                                    13 |      13 |
|  7782 | CLARK    |  2450.00 |                                    14 |      14 |
|  7499 | ALLEN    |  1600.00 |                                    15 |      15 |
|  7844 | TURNER   |  1500.00 |                                    16 |      16 |
|  7934 | MILLER   |  1300.00 |                                    17 |      17 |
|  7521 | WARD     |  1250.00 |                                    18 |      18 |
|  7654 | MARTIN   |  1250.00 |                                    19 |      18 |
|  7876 | ADAMS    |  1100.00 |                                    20 |      20 |
|  7900 | JAMES    |   950.00 |                                    21 |      21 |
+-------+----------+----------+---------------------------------------+---------+
21 rows in set (0.00 sec)

mysql> select empno,ename,sal,row_number() over (order by sal desc) rownum,rank() over (order by sal desc) ranknum
    -> from emp;
+-------+----------+----------+--------+---------+
| empno | ename    | sal      | rownum | ranknum |
+-------+----------+----------+--------+---------+
|   125 | Atharva  | 55678.00 |      1 |       1 |
|   100 | Rajat_k  | 45678.00 |      2 |       2 |
|   123 | Revati   | 45678.00 |      3 |       2 |
|   101 | Ashwin   | 34566.00 |      4 |       4 |
|   102 | Ashwini  | 34566.00 |      5 |       4 |
|   103 | Deepa    | 34466.00 |      6 |       6 |
|   104 | Sangeeta | 34466.00 |      7 |       6 |
|  7839 | KING     |  5000.00 |      8 |       8 |
|  7369 | SMITH    |  4975.00 |      9 |       9 |
|  7788 | SCOTT    |  3000.00 |     10 |      10 |
|  7902 | FORD     |  3000.00 |     11 |      10 |
|  7566 | JONES    |  2975.00 |     12 |      12 |
|  7698 | BLAKE    |  2850.00 |     13 |      13 |
|  7782 | CLARK    |  2450.00 |     14 |      14 |
|  7499 | ALLEN    |  1600.00 |     15 |      15 |
|  7844 | TURNER   |  1500.00 |     16 |      16 |
|  7934 | MILLER   |  1300.00 |     17 |      17 |
|  7521 | WARD     |  1250.00 |     18 |      18 |
|  7654 | MARTIN   |  1250.00 |     19 |      18 |
|  7876 | ADAMS    |  1100.00 |     20 |      20 |
|  7900 | JAMES    |   950.00 |     21 |      21 |
+-------+----------+----------+--------+---------+
21 rows in set (0.00 sec)

mysql> select empno,ename,sal,row_number() over (order by sal desc) rownum,rank() over (order by sal desc) ranknum,dense_rank() over (order by sal desc) drank
    -> from emp;
+-------+----------+----------+--------+---------+-------+
| empno | ename    | sal      | rownum | ranknum | drank |
+-------+----------+----------+--------+---------+-------+
|   125 | Atharva  | 55678.00 |      1 |       1 |     1 |
|   100 | Rajat_k  | 45678.00 |      2 |       2 |     2 |
|   123 | Revati   | 45678.00 |      3 |       2 |     2 |
|   101 | Ashwin   | 34566.00 |      4 |       4 |     3 |
|   102 | Ashwini  | 34566.00 |      5 |       4 |     3 |
|   103 | Deepa    | 34466.00 |      6 |       6 |     4 |
|   104 | Sangeeta | 34466.00 |      7 |       6 |     4 |
|  7839 | KING     |  5000.00 |      8 |       8 |     5 |
|  7369 | SMITH    |  4975.00 |      9 |       9 |     6 |
|  7788 | SCOTT    |  3000.00 |     10 |      10 |     7 |
|  7902 | FORD     |  3000.00 |     11 |      10 |     7 |
|  7566 | JONES    |  2975.00 |     12 |      12 |     8 |
|  7698 | BLAKE    |  2850.00 |     13 |      13 |     9 |
|  7782 | CLARK    |  2450.00 |     14 |      14 |    10 |
|  7499 | ALLEN    |  1600.00 |     15 |      15 |    11 |
|  7844 | TURNER   |  1500.00 |     16 |      16 |    12 |
|  7934 | MILLER   |  1300.00 |     17 |      17 |    13 |
|  7521 | WARD     |  1250.00 |     18 |      18 |    14 |
|  7654 | MARTIN   |  1250.00 |     19 |      18 |    14 |
|  7876 | ADAMS    |  1100.00 |     20 |      20 |    15 |
|  7900 | JAMES    |   950.00 |     21 |      21 |    16 |
+-------+----------+----------+--------+---------+-------+
21 rows in set (0.04 sec)

mysql> select empno,ename,sal,row_number() over (order by sal desc) rownum,rank() over (order by sal desc) ranknum,dense_rank() over (order by sal desc) drank
    -> from emp
    -> where dens_rank() over (order by sal desc)=3;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'over (order by sal desc)=3' at line 3
mysql> select empno,ename,sal,row_number() over (order by sal desc) rownum,rank() over (order by sal desc) ranknum,dense_rank() over (order by sal desc) drankfrom emp
    -> where drank=3;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'emp
where drank=3' at line 1
mysql> WITH emp_numbered AS (
    ->   SELECT empno,ename,sal, row_number() over(ORDER BY sal DESC) AS rn
    ->   FROM emp
    -> )
    -> ;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 4
mysql> WITH emp_numbered  AS (
    ->   SELECT empno,ename,sal, row_number() over(ORDER BY sal DESC) AS rn
    ->   FROM emp
    -> )
    -> ;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 4
mysql> with emp_number as(
    -> select empno,ename,sal,row_number() over (order by sal desc)
    -> rn
    -> from emp);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 4
mysql> with emp_number as (
    -> select empno,ename,sal,row_number() over (order by sal desc) rn
    -> from emp);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 3
mysql> WITH RECURSIVE my_cte AS
    -> (
    ->   SELECT 1 AS n
    ->   UNION ALL
    ->   SELECT 1+n FROM my_cte WHERE n<10
    -> )
    -> SELECT * FROM my_cte;
+------+
| n    |
+------+
|    1 |
|    2 |
|    3 |
|    4 |
|    5 |
|    6 |
|    7 |
|    8 |
|    9 |
|   10 |
+------+
10 rows in set (0.00 sec)

mysql> SELECT *
    -> from (SELECT empno,ename,sal, row_number() over(ORDER BY sal DESC) AS rn
    ->      FROM emp) e;
+-------+----------+----------+----+
| empno | ename    | sal      | rn |
+-------+----------+----------+----+
|   125 | Atharva  | 55678.00 |  1 |
|   100 | Rajat_k  | 45678.00 |  2 |
|   123 | Revati   | 45678.00 |  3 |
|   101 | Ashwin   | 34566.00 |  4 |
|   102 | Ashwini  | 34566.00 |  5 |
|   103 | Deepa    | 34466.00 |  6 |
|   104 | Sangeeta | 34466.00 |  7 |
|  7839 | KING     |  5000.00 |  8 |
|  7369 | SMITH    |  4975.00 |  9 |
|  7788 | SCOTT    |  3000.00 | 10 |
|  7902 | FORD     |  3000.00 | 11 |
|  7566 | JONES    |  2975.00 | 12 |
|  7698 | BLAKE    |  2850.00 | 13 |
|  7782 | CLARK    |  2450.00 | 14 |
|  7499 | ALLEN    |  1600.00 | 15 |
|  7844 | TURNER   |  1500.00 | 16 |
|  7934 | MILLER   |  1300.00 | 17 |
|  7521 | WARD     |  1250.00 | 18 |
|  7654 | MARTIN   |  1250.00 | 19 |
|  7876 | ADAMS    |  1100.00 | 20 |
|  7900 | JAMES    |   950.00 | 21 |
+-------+----------+----------+----+
21 rows in set (0.00 sec)

mysql> SELECT *
    -> from (SELECT empno,ename,sal, row_number() over(ORDER BY sal DESC) AS rn
    ->      FROM emp) e;
+-------+----------+----------+----+
| empno | ename    | sal      | rn |
+-------+----------+----------+----+
|   125 | Atharva  | 55678.00 |  1 |
|   100 | Rajat_k  | 45678.00 |  2 |
|   123 | Revati   | 45678.00 |  3 |
|   101 | Ashwin   | 34566.00 |  4 |
|   102 | Ashwini  | 34566.00 |  5 |
|   103 | Deepa    | 34466.00 |  6 |
|   104 | Sangeeta | 34466.00 |  7 |
|  7839 | KING     |  5000.00 |  8 |
|  7369 | SMITH    |  4975.00 |  9 |
|  7788 | SCOTT    |  3000.00 | 10 |
|  7902 | FORD     |  3000.00 | 11 |
|  7566 | JONES    |  2975.00 | 12 |
|  7698 | BLAKE    |  2850.00 | 13 |
|  7782 | CLARK    |  2450.00 | 14 |
|  7499 | ALLEN    |  1600.00 | 15 |
|  7844 | TURNER   |  1500.00 | 16 |
|  7934 | MILLER   |  1300.00 | 17 |
|  7521 | WARD     |  1250.00 | 18 |
|  7654 | MARTIN   |  1250.00 | 19 |
|  7876 | ADAMS    |  1100.00 | 20 |
|  7900 | JAMES    |   950.00 | 21 |
+-------+----------+----------+----+
21 rows in set (0.00 sec)

mysql> SELECT *
    -> from (SELECT empno,ename,sal, row_number() over(ORDER BY sal DESC) AS rn
    ->      FROM emp) e
    -> where e.rn=3;
+-------+--------+----------+----+
| empno | ename  | sal      | rn |
+-------+--------+----------+----+
|   123 | Revati | 45678.00 |  3 |
+-------+--------+----------+----+
1 row in set (0.00 sec)

mysql> SELECT empno,ename,sal, row_number() over( partition by deptno ORDER BY sal DESC) AS rn
    -> from emp;
+-------+----------+----------+----+
| empno | ename    | sal      | rn |
+-------+----------+----------+----+
|   125 | Atharva  | 55678.00 |  1 |
|   123 | Revati   | 45678.00 |  2 |
|   100 | Rajat_k  | 45678.00 |  1 |
|   101 | Ashwin   | 34566.00 |  2 |
|   102 | Ashwini  | 34566.00 |  3 |
|   104 | Sangeeta | 34466.00 |  4 |
|  7839 | KING     |  5000.00 |  5 |
|  7782 | CLARK    |  2450.00 |  6 |
|  7934 | MILLER   |  1300.00 |  7 |
|  7369 | SMITH    |  4975.00 |  1 |
|  7788 | SCOTT    |  3000.00 |  2 |
|  7902 | FORD     |  3000.00 |  3 |
|  7566 | JONES    |  2975.00 |  4 |
|  7876 | ADAMS    |  1100.00 |  5 |
|   103 | Deepa    | 34466.00 |  1 |
|  7698 | BLAKE    |  2850.00 |  2 |
|  7499 | ALLEN    |  1600.00 |  3 |
|  7844 | TURNER   |  1500.00 |  4 |
|  7521 | WARD     |  1250.00 |  5 |
|  7654 | MARTIN   |  1250.00 |  6 |
|  7900 | JAMES    |   950.00 |  7 |
+-------+----------+----------+----+
21 rows in set (0.00 sec)

mysql> SELECT empno,ename,sal,deptno, row_number() over( partition by deptno ORDER BY sal DESC) AS rn
    -> from emp;
+-------+----------+----------+--------+----+
| empno | ename    | sal      | deptno | rn |
+-------+----------+----------+--------+----+
|   125 | Atharva  | 55678.00 |   NULL |  1 |
|   123 | Revati   | 45678.00 |   NULL |  2 |
|   100 | Rajat_k  | 45678.00 |     10 |  1 |
|   101 | Ashwin   | 34566.00 |     10 |  2 |
|   102 | Ashwini  | 34566.00 |     10 |  3 |
|   104 | Sangeeta | 34466.00 |     10 |  4 |
|  7839 | KING     |  5000.00 |     10 |  5 |
|  7782 | CLARK    |  2450.00 |     10 |  6 |
|  7934 | MILLER   |  1300.00 |     10 |  7 |
|  7369 | SMITH    |  4975.00 |     20 |  1 |
|  7788 | SCOTT    |  3000.00 |     20 |  2 |
|  7902 | FORD     |  3000.00 |     20 |  3 |
|  7566 | JONES    |  2975.00 |     20 |  4 |
|  7876 | ADAMS    |  1100.00 |     20 |  5 |
|   103 | Deepa    | 34466.00 |     30 |  1 |
|  7698 | BLAKE    |  2850.00 |     30 |  2 |
|  7499 | ALLEN    |  1600.00 |     30 |  3 |
|  7844 | TURNER   |  1500.00 |     30 |  4 |
|  7521 | WARD     |  1250.00 |     30 |  5 |
|  7654 | MARTIN   |  1250.00 |     30 |  6 |
|  7900 | JAMES    |   950.00 |     30 |  7 |
+-------+----------+----------+--------+----+
21 rows in set (0.00 sec)

mysql> select * from (SELECT empno,ename,sal,deptno, row_number() over( partition by deptno ORDER BY sal DESC) AS rn,dense_rank() over (partion by deptno order by sal desc) drn) e
    -> where e.drn=1;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'by deptno order by sal desc) drn) e
where e.drn=1' at line 1
mysql> select *
    -> from (SELECT empno,ename,sal,deptno,row_number()
    -> over( partition by deptno ORDER BY sal DESC) AS rn,
    -> dense_rank() over (partition by deptno order by sal desc) drn) e
    ->  where e.drn=1;
ERROR 1054 (42S22): Unknown column 'empno' in 'field list'
mysql> select *
    -> from (SELECT empno,ename,sal,deptno,row_number()
    -> over( partition by deptno ORDER BY sal DESC) AS rn,
    -> dense_rank() over (partition by deptno order by sal desc
    -> ) drn from emp) e
    ->  where e.drn=1;
+-------+---------+----------+--------+----+-----+
| empno | ename   | sal      | deptno | rn | drn |
+-------+---------+----------+--------+----+-----+
|   125 | Atharva | 55678.00 |   NULL |  1 |   1 |
|   100 | Rajat_k | 45678.00 |     10 |  1 |   1 |
|  7369 | SMITH   |  4975.00 |     20 |  1 |   1 |
|   103 | Deepa   | 34466.00 |     30 |  1 |   1 |
+-------+---------+----------+--------+----+-----+
4 rows in set (0.05 sec)

mysql> empno,ename,sal,LEAD(sal) OVER (
    ->   ORDER BY job)  AS lead
    -> FROM emp e
    -> ORDER BY sal;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'empno,ename,sal,LEAD(sal) OVER (
  ORDER BY job)  AS lead
FROM emp e
ORDER BY sa' at line 1
mysql> select
    ->   empno,ename,sal,LEAD(sal) OVER (
    ->   ORDER BY job)  AS lead
    -> FROM emp e
    -> ORDER BY sal;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'lead
FROM emp e
ORDER BY sal' at line 3
mysql> select empno,ename,sal,lead(sal) over (order by sal) lead
    -> from emp e
    -> order by sal;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'lead
from emp e
order by sal' at line 1
mysql> select empno,ename,sal,lead(sal,1) over (order by sal) lead
    -> from emp;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'lead
from emp' at line 1
mysql> select empno,ename,sal,lead(sal,1) over (order by sal) leaddata
    -> from emp;
+-------+----------+----------+----------+
| empno | ename    | sal      | leaddata |
+-------+----------+----------+----------+
|  7900 | JAMES    |   950.00 |  1100.00 |
|  7876 | ADAMS    |  1100.00 |  1250.00 |
|  7521 | WARD     |  1250.00 |  1250.00 |
|  7654 | MARTIN   |  1250.00 |  1300.00 |
|  7934 | MILLER   |  1300.00 |  1500.00 |
|  7844 | TURNER   |  1500.00 |  1600.00 |
|  7499 | ALLEN    |  1600.00 |  2450.00 |
|  7782 | CLARK    |  2450.00 |  2850.00 |
|  7698 | BLAKE    |  2850.00 |  2975.00 |
|  7566 | JONES    |  2975.00 |  3000.00 |
|  7788 | SCOTT    |  3000.00 |  3000.00 |
|  7902 | FORD     |  3000.00 |  4975.00 |
|  7369 | SMITH    |  4975.00 |  5000.00 |
|  7839 | KING     |  5000.00 | 34466.00 |
|   103 | Deepa    | 34466.00 | 34466.00 |
|   104 | Sangeeta | 34466.00 | 34566.00 |
|   101 | Ashwin   | 34566.00 | 34566.00 |
|   102 | Ashwini  | 34566.00 | 45678.00 |
|   100 | Rajat_k  | 45678.00 | 45678.00 |
|   123 | Revati   | 45678.00 | 55678.00 |
|   125 | Atharva  | 55678.00 |     NULL |
+-------+----------+----------+----------+
21 rows in set (0.00 sec)

mysql> select empno,ename,sal,lead(sal,1) over (order by sal) leaddata, lag(sal,2) over (order by sal) lagdata
    -> from emp e;
+-------+----------+----------+----------+----------+
| empno | ename    | sal      | leaddata | lagdata  |
+-------+----------+----------+----------+----------+
|  7900 | JAMES    |   950.00 |  1100.00 |     NULL |
|  7876 | ADAMS    |  1100.00 |  1250.00 |     NULL |
|  7521 | WARD     |  1250.00 |  1250.00 |   950.00 |
|  7654 | MARTIN   |  1250.00 |  1300.00 |  1100.00 |
|  7934 | MILLER   |  1300.00 |  1500.00 |  1250.00 |
|  7844 | TURNER   |  1500.00 |  1600.00 |  1250.00 |
|  7499 | ALLEN    |  1600.00 |  2450.00 |  1300.00 |
|  7782 | CLARK    |  2450.00 |  2850.00 |  1500.00 |
|  7698 | BLAKE    |  2850.00 |  2975.00 |  1600.00 |
|  7566 | JONES    |  2975.00 |  3000.00 |  2450.00 |
|  7788 | SCOTT    |  3000.00 |  3000.00 |  2850.00 |
|  7902 | FORD     |  3000.00 |  4975.00 |  2975.00 |
|  7369 | SMITH    |  4975.00 |  5000.00 |  3000.00 |
|  7839 | KING     |  5000.00 | 34466.00 |  3000.00 |
|   103 | Deepa    | 34466.00 | 34466.00 |  4975.00 |
|   104 | Sangeeta | 34466.00 | 34566.00 |  5000.00 |
|   101 | Ashwin   | 34566.00 | 34566.00 | 34466.00 |
|   102 | Ashwini  | 34566.00 | 45678.00 | 34466.00 |
|   100 | Rajat_k  | 45678.00 | 45678.00 | 34566.00 |
|   123 | Revati   | 45678.00 | 55678.00 | 34566.00 |
|   125 | Atharva  | 55678.00 |     NULL | 45678.00 |
+-------+----------+----------+----------+----------+
21 rows in set (0.00 sec)

mysql> select empno,ename,sal,lead(sal,1) over (order by sal) leaddata, lag(sal,2) over (order by sal) lagdata,first_value(sal) over (order by sal)
    -> from emp;
+-------+----------+----------+----------+----------+--------------------------------------+
| empno | ename    | sal      | leaddata | lagdata  | first_value(sal) over (order by sal) |
+-------+----------+----------+----------+----------+--------------------------------------+
|  7900 | JAMES    |   950.00 |  1100.00 |     NULL |                               950.00 |
|  7876 | ADAMS    |  1100.00 |  1250.00 |     NULL |                               950.00 |
|  7521 | WARD     |  1250.00 |  1250.00 |   950.00 |                               950.00 |
|  7654 | MARTIN   |  1250.00 |  1300.00 |  1100.00 |                               950.00 |
|  7934 | MILLER   |  1300.00 |  1500.00 |  1250.00 |                               950.00 |
|  7844 | TURNER   |  1500.00 |  1600.00 |  1250.00 |                               950.00 |
|  7499 | ALLEN    |  1600.00 |  2450.00 |  1300.00 |                               950.00 |
|  7782 | CLARK    |  2450.00 |  2850.00 |  1500.00 |                               950.00 |
|  7698 | BLAKE    |  2850.00 |  2975.00 |  1600.00 |                               950.00 |
|  7566 | JONES    |  2975.00 |  3000.00 |  2450.00 |                               950.00 |
|  7788 | SCOTT    |  3000.00 |  3000.00 |  2850.00 |                               950.00 |
|  7902 | FORD     |  3000.00 |  4975.00 |  2975.00 |                               950.00 |
|  7369 | SMITH    |  4975.00 |  5000.00 |  3000.00 |                               950.00 |
|  7839 | KING     |  5000.00 | 34466.00 |  3000.00 |                               950.00 |
|   103 | Deepa    | 34466.00 | 34466.00 |  4975.00 |                               950.00 |
|   104 | Sangeeta | 34466.00 | 34566.00 |  5000.00 |                               950.00 |
|   101 | Ashwin   | 34566.00 | 34566.00 | 34466.00 |                               950.00 |
|   102 | Ashwini  | 34566.00 | 45678.00 | 34466.00 |                               950.00 |
|   100 | Rajat_k  | 45678.00 | 45678.00 | 34566.00 |                               950.00 |
|   123 | Revati   | 45678.00 | 55678.00 | 34566.00 |                               950.00 |
|   125 | Atharva  | 55678.00 |     NULL | 45678.00 |                               950.00 |
+-------+----------+----------+----------+----------+--------------------------------------+
21 rows in set (0.00 sec)

mysql> delimiter //
mysql> create procedure insertdept(did int,dnm varchar(20),dloc varchar(2))
    -> begin
    ->     insert into dept values(did,dnm,dloc)
    -> end//
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'end' at line 4
mysql> delimiter //
mysql> create procedure insertdept(did int,dnm varchar(20),dloc varchar(20))
    -> begin
    ->     insert into dept values(did,dnm,dloc);
    -> end//
Query OK, 0 rows affected (0.06 sec)

mysql> delimiter ;
mysql> call insertdept(10,'admin','pune');
ERROR 1062 (23000): Duplicate entry '10' for key 'dept.PRIMARY'
mysql> call insertdept(8,'admin','pune');
Query OK, 1 row affected (0.00 sec)

mysql> select * from dept;
+--------+------------+----------+
| DEPTNO | DNAME      | LOC      |
+--------+------------+----------+
|      8 | admin      | pune     |
|     10 | ACCOUNTING | NEW YORK |
|     20 | RESEARCH   | DALLAS   |
|     30 | SALES      | CHICAGO  |
|     40 | OPERATIONS | BOSTON   |
+--------+------------+----------+
5 rows in set (0.00 sec)

mysql> delimiter //
mysql> create procedure finddata(eid int,out esal float(9,2),out ecomm float(9,2))
    -> begin
    ->     select sal,comm into esal,ecomm
    -> from emp
    -> where empno=eid
    -> end//
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'end' at line 6
mysql> delimiter //
mysql> create procedure finddata(eid int,out esal float(9,2),out ecomm float(9,2))
    -> begin
    ->     select sal,comm into esal,ecomm
    -> from emp
    -> where empno=eid;
    -> end//
Query OK, 0 rows affected, 2 warnings (0.05 sec)

mysql> delimiter ;
mysql> call finddata(7902,@s,@c);
Query OK, 1 row affected (0.00 sec)

mysql> select @s,@c;
+------+------+
| @s   | @c   |
+------+------+
| 3000 | NULL |
+------+------+
1 row in set (0.00 sec)

mysql> select * from emp;
+-------+----------+-----------+------+------------+----------+---------+--------+
| EMPNO | ENAME    | JOB       | MGR  | HIREDATE   | SAL      | COMM    | DEPTNO |
+-------+----------+-----------+------+------------+----------+---------+--------+
|   100 | Rajat_k  | CLERK     | 7902 | 1982-03-04 | 45678.00 | 3456.00 |     10 |
|   101 | Ashwin   | manager   | NULL | 2020-01-01 | 34566.00 | 3456.00 |     10 |
|   102 | Ashwini  | CLERK     | 7902 | 2020-01-01 | 34566.00 | 3456.00 |     10 |
|   103 | Deepa    | CLERK     | 7902 | 2022-01-01 | 34466.00 | 3456.00 |     30 |
|   104 | Sangeeta | CLERK     | 7902 | 2022-01-01 | 34466.00 | 3456.00 |     10 |
|   123 | Revati   | design    | NULL | 2020-03-12 | 45678.00 | 4567.00 |   NULL |
|   125 | Atharva  | design    | NULL | 2021-03-15 | 55678.00 | 4567.00 |   NULL |
|  7369 | SMITH    | CLERK     | 7902 | 1980-12-17 |  4975.00 |    NULL |     20 |
|  7499 | ALLEN    | SALESMAN  | 7698 | 1981-02-20 |  1600.00 |  300.00 |     30 |
|  7521 | WARD     | SALESMAN  | 7698 | 1981-02-22 |  1250.00 |  500.00 |     30 |
|  7566 | JONES    | MANAGER   | 7839 | 1981-04-02 |  2975.00 |    NULL |     20 |
|  7654 | MARTIN   | SALESMAN  | 7698 | 1981-09-28 |  1250.00 | 1400.00 |     30 |
|  7698 | BLAKE    | MANAGER   | 7839 | 1981-05-01 |  2850.00 |    NULL |     30 |
|  7782 | CLARK    | MANAGER   | 7839 | 1981-06-09 |  2450.00 |    NULL |     10 |
|  7788 | SCOTT    | ANALYST   | 7566 | 1982-12-09 |  3000.00 |    NULL |     20 |
|  7839 | KING     | PRESIDENT | NULL | 1981-11-17 |  5000.00 |    NULL |     10 |
|  7844 | TURNER   | SALESMAN  | 7698 | 1981-09-08 |  1500.00 |    0.00 |     30 |
|  7876 | ADAMS    | CLERK     | 7788 | 1983-01-12 |  1100.00 |    NULL |     20 |
|  7900 | JAMES    | CLERK     | 7698 | 1981-12-03 |   950.00 |    NULL |     30 |
|  7902 | FORD     | ANALYST   | 7566 | 1981-12-03 |  3000.00 |    NULL |     20 |
|  7934 | MILLER   | CLERK     | 7782 | 1982-01-23 |  1300.00 |    NULL |     10 |
+-------+----------+-----------+------+------------+----------+---------+--------+
21 rows in set (0.00 sec)

mysql> call finddata(104,@s,@c);
Query OK, 1 row affected (0.00 sec)

mysql> select @s,@c;
+-------+------+
| @s    | @c   |
+-------+------+
| 34466 | 3456 |
+-------+------+
1 row in set (0.00 sec)

mysql> delimiter //
mysql> create procedure getempdetails(in did int,out cnt int,out maxsal float(9,2))
    -> begin
    ->     select count(*),max(sal) into cnt,maxsal
    -> from emp
    -> where detno=did;
    -> end//
Query OK, 0 rows affected, 1 warning (0.01 sec)

mysql> delimiter ;
mysql> call getempdetails(10,@c,@ms);
ERROR 1054 (42S22): Unknown column 'detno' in 'where clause'
mysql> drop procedure getempdetails;
Query OK, 0 rows affected (0.06 sec)

mysql> delimiter //
mysql> create procedure getempdetails(in did int,out cnt int,out maxsal float(9,2))
    -> begin
    ->     select count(*),max(sal) into cnt,maxsal
    -> from emp
    -> where deptno=did;
    -> end//
Query OK, 0 rows affected, 1 warning (0.05 sec)

mysql> delimiter ;
mysql> call getempdetails(10,@c,@ms);
Query OK, 1 row affected (0.00 sec)

mysql> select @c,@ms;
+------+-------+
| @c   | @ms   |
+------+-------+
|    7 | 45678 |
+------+-------+
1 row in set (0.00 sec)

mysql> delimiter //
mysql> create procedure increasecnt(inout cnt int)
    -> begin
    ->     set cnt=cnt+10;
    -> end//
Query OK, 0 rows affected (0.01 sec)

mysql> delimiter ;
mysql> set @c=10;
Query OK, 0 rows affected (0.00 sec)

mysql> call increasecnt(@c);
Query OK, 0 rows affected (0.00 sec)

mysql> select @c;
+------+
| @c   |
+------+
|   20 |
+------+
1 row in set (0.00 sec)

mysql> delimiter //
mysql> create procedure getRemark(eid int,out remark varchar(50))
    -> begin
    ->     declare vcomm float(9,2) default 0
    -> select comm into vcomm
    -> from emp
    -> where empno=eid
    -> if vcomm is null or vcomm=0 then
    ->     set remark='poor perfformance';
    -> elseif vcomm <=300 then
    -> set remark='ok perfformance';
    -> elseif vcomm <500 then
    -> set remark='ok perfformance';
    -> else
    ->     set remark='excellent perfformance';
    -> end if;
    -> select vcomm,remark;
    -> end//
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'select comm into vcomm
from emp
where empno=eid
if vcomm is null or vcomm=0 then' at line 4
mysql> delimiter ;
mysql> delimiter //
mysql> create procedure getRemark(eid int,out remark varchar(50))
    -> begin
    ->     declare vcomm float(9,2) default 0
    -> select comm into vcomm
    -> from emp
    -> where empno=eid;
    -> if vcomm is null or vcomm=0 then
    ->     set remark='poor perfformance';
    -> elseif vcomm <=300 then
    -> set remark='ok perfformance';
    -> elseif vcomm <500 then
    -> set remark='ok perfformance';
    -> else
    ->     set remark='excellent perfformance';
    -> end if;
    -> select vcomm,remark;
    -> end//
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'select comm into vcomm
from emp
where empno=eid;
if vcomm is null or vcomm=0 the' at line 4
mysql> delimiter //
mysql> create procedure getRemark(eid int,out remark varchar(50))
    -> begin
    ->     declare vcomm float(9,2) default 0^C
mysql> delimiter //
mysql> create procedure getRemark(eid int,out remark varchar(50))
    -> begin
    ->     declare vcomm float(9,2) default 0;
    -> select comm into vcomm
    -> from emp
    -> where empno=eid;
    -> if vcomm is null or vcomm=0 then
    ->     set remark='poor perfformance';
    -> elseif vcomm <=300 then
    -> set remark='ok perfformance';
    -> elseif vcomm <500 then
    -> set remark='ok perfformance';
    -> else
    ->     set remark='excellent perfformance';
    -> end if;
    -> select vcomm,remark;
    -> end//
Query OK, 0 rows affected, 1 warning (0.01 sec)

mysql> delimiter ;
mysql> call getremark(104,@r);
+---------+------------------------+
| vcomm   | remark                 |
+---------+------------------------+
| 3456.00 | excellent perfformance |
+---------+------------------------+
1 row in set (0.00 sec)

Query OK, 0 rows affected (0.01 sec)

mysql> call getremark(7902,@r);
+-------+-------------------+
| vcomm | remark            |
+-------+-------------------+
|  NULL | poor perfformance |
+-------+-------------------+
1 row in set (0.00 sec)

Query OK, 0 rows affected (0.00 sec)

mysql> delimiter //
mysql> create procedure getremark1(eid int,out remark varchar(50))
    -> begin
    ->     declare netsal float(9,2) default 0;
    -> select sal+ifnull(comm,0) into netsal
    -> from emp
    -> where empno=eid;
    -> if netsal <  1000 then
    ->     set remark='less';
    -> elseif netsal < 2000 then
    -> set remark='ok ';
    -> elseif netsal <3000 then
    -> set remark='good';
    -> else
    ->     set remark='better';
    -> end if;
    -> select netsal,remark;
    -> end//
Query OK, 0 rows affected, 1 warning (0.05 sec)

mysql> delimiter ;
mysql> call getremark1 (104,@r);
+----------+--------+
| netsal   | remark |
+----------+--------+
| 37922.00 | better |
+----------+--------+
1 row in set (0.00 sec)

Query OK, 0 rows affected (0.00 sec)

mysql> delimiter //
mysql> create procedure displaynumwhile(num int)
    -> begin
    ->     declare str varchar(20) default '';
    -> declare n int default 1;
    -> while n<=num then
    ->      set str=concat(str,n,',');
    ->  set n=n+1;
    -> end while;
    -> str=substr(str,1,length(str)-1);
    -> select str;
    -> end//
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'then
     set str=concat(str,n,',');
 set n=n+1;
end while;
str=substr(str' at line 5
mysql> delimiter ;
mysql> delimiter //
mysql> create procedure displaynumwhile(num int)
    -> begin
    ->     declare str varchar(20) default '';
    -> declare n int default 1;
    -> while n<=num do
    ->      set str=concat(str,n,',');
    ->  set n=n+1;
    -> end while;
    -> str=substr(str,1,length(str)-1);
    -> select str;
    -> end//
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '=substr(str,1,length(str)-1);
select str;
end' at line 9
mysql> delimiter //
mysql> create procedure displaynumwhile(num int)
    -> begin
    ->     declare str varchar(20) default '';
    -> declare n int default 1;
    -> while n<=num do
    ->      set str=concat(str,n,',');
    ->  set n=n+1;
    -> end while;
    -> set str=substr(str,1,length(str)-1);
    -> select str;
    -> end//
Query OK, 0 rows affected (0.01 sec)

mysql> delimiter ;
mysql> call displaynumwhile(10);
ERROR 1406 (22001): Data too long for column 'str' at row 1
mysql> call displaynumwhile(5);
+-----------+
| str       |
+-----------+
| 1,2,3,4,5 |
+-----------+
1 row in set (0.00 sec)

Query OK, 0 rows affected (0.00 sec)

mysql> drop procedure  displaynumwhile;
Query OK, 0 rows affected (0.01 sec)

mysql> delimiter //
mysql> create procedure displaynumwhile(num int)
    -> begin
    ->     declare str varchar(50) default '';
    -> declare n int default 1;
    -> while n<=num do
    ->      set str=concat(str,n,',');
    ->  set n=n+1;
    -> end while;
    -> set str=substr(str,1,length(str)-1);
    -> select str;
    -> end//
Query OK, 0 rows affected (0.01 sec)

mysql> delimiter ;
mysql> call displaynumwhile(10);
+----------------------+
| str                  |
+----------------------+
| 1,2,3,4,5,6,7,8,9,10 |
+----------------------+
1 row in set (0.00 sec)

Query OK, 0 rows affected (0.00 sec)

mysql> delimiter //
mysql> create procedure displaynumrepeat(num int)
    -> begin
    ->     declare str varchar(50) default '';
    -> declare n int default 1;
    -> repeat
    ->      set str=concat(str,n,',');
    ->  set n=n+1;
    ->  until n>num
    -> end repeat;
    -> set str=substr(str,1,length(str)-1);
    -> select str;
    -> end//
Query OK, 0 rows affected (0.05 sec)

mysql> delimiter ;
mysql> call displaynumrepeat(10);
+----------------------+
| str                  |
+----------------------+
| 1,2,3,4,5,6,7,8,9,10 |
+----------------------+
1 row in set (0.00 sec)

Query OK, 0 rows affected (0.00 sec)

mysql> delimiter //
mysql> create procedure displaynumrepeat(num int)
    -> begin
    ->     declare str varchar(50) default '';
    -> declare n int default 1;
    -> label1:loop
    ->      set str=concat(str,n,',');
    ->  set n=n+1;
    ->  if n>num then
    ->     leave label1;
    ->  end if;
    -> end loop;
    -> set str=substr(str,1,length(str)-1);
    -> select str;
    -> end//
ERROR 1304 (42000): PROCEDURE displaynumrepeat already exists
mysql> delimiter //
mysql> create procedure displaynumloop(num int)
    -> begin
    ->     declare str varchar(50) default '';
    -> declare n int default 1;
    -> label1:loop
    ->      set str=concat(str,n,',');
    ->  set n=n+1;
    ->  if n>num then
    ->     leave label1;
    ->  end if;
    -> end loop;
    -> set str=substr(str,1,length(str)-1);
    -> select str;
    -> end//
Query OK, 0 rows affected (0.01 sec)

mysql> delimiter ;
mysql> call displaynumloop(10);
+----------------------+
| str                  |
+----------------------+
| 1,2,3,4,5,6,7,8,9,10 |
+----------------------+
1 row in set (0.00 sec)

Query OK, 0 rows affected (0.00 sec)

mysql> delimiter //
mysql> create procedure displayallemp()
    -> begin
    ->     declare vset,vempno int default 0;
    -> declare vname vrchar(20);
    ->     declare empcur cursor for select empno,ename from emp;
    -> declare continue handler NOT FOUND set vset=1
    -> open empcur;
    -> label1: loop
    -> fetch empcur into vempno,vname;
    -> if vset=1 then
    ->    leave lable1
    -> end if;
    -> select vempno,vname;
    -> end loop;
    -> close empcur;
    -> end//
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'vrchar(20);
    declare empcur cursor for select empno,ename from emp;
declare c' at line 4
mysql> delimiter //
mysql> create procedure displayallemp()
    -> begin
    ->     declare vset,vempno int default 0;
    -> declare vname varchar(20);
    ->     declare empcur cursor for select empno,ename from emp;
    -> declare continue handler NOT FOUND set vset=1
    -> open empcur;
    -> label1: loop
    -> fetch empcur into vempno,vname;
    -> if vset=1 then
    ->    leave lable1
    -> end if;
    -> select vempno,vname;
    -> end loop;
    -> close empcur;
    -> end//
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'NOT FOUND set vset=1
open empcur;
label1: loop
fetch empcur into vempno,vname;
i' at line 6
mysql> delimiter ;
mysql> delimiter //
mysql> create procedure displayallemp()
    -> begin
    ->     declare vset,vempno int default 0;
    -> declare vname varchar(20);
    ->     declare empcur cursor for select empno,ename from emp;
    -> declare continue handler NOT FOUND set vset=1;
    -> open empcur;
    -> lable1: loop
    -> fetch empcur into vempno,vname;
    -> if vset=1 then
    ->    leave lable1;
    -> end if;
    -> select vempno,vname;
    -> end loop;
    -> close empcur;
    -> end//
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'NOT FOUND set vset=1;
open empcur;
lable1: loop
fetch empcur into vempno,vname;
' at line 6
mysql> delimiter //
mysql> create procedure displayallemp()
    -> begin
    ->     declare vset,vempno int default 0;
    -> declare vname varchar(20);
    ->     declare empcur cursor for select empno,ename from emp;
    -> declare continue handler for NOT FOUND set vset=1;
    -> open empcur;
    -> lable1: loop
    -> fetch empcur into vempno,vname;
    -> if vset=1 then
    ->    leave lable1;
    -> end if;
    -> select vempno,vname;
    -> end loop;
    -> close empcur;
    -> end//
Query OK, 0 rows affected (0.06 sec)

mysql> delimiter ;
mysql> call displayallemp();
+--------+---------+
| vempno | vname   |
+--------+---------+
|    100 | Rajat_k |
+--------+---------+
1 row in set (0.05 sec)

+--------+--------+
| vempno | vname  |
+--------+--------+
|    101 | Ashwin |
+--------+--------+
1 row in set (0.05 sec)

+--------+---------+
| vempno | vname   |
+--------+---------+
|    102 | Ashwini |
+--------+---------+
1 row in set (0.05 sec)

+--------+-------+
| vempno | vname |
+--------+-------+
|    103 | Deepa |
+--------+-------+
1 row in set (0.06 sec)

+--------+----------+
| vempno | vname    |
+--------+----------+
|    104 | Sangeeta |
+--------+----------+
1 row in set (0.07 sec)

+--------+--------+
| vempno | vname  |
+--------+--------+
|    123 | Revati |
+--------+--------+
1 row in set (0.08 sec)

+--------+---------+
| vempno | vname   |
+--------+---------+
|    125 | Atharva |
+--------+---------+
1 row in set (0.08 sec)

+--------+-------+
| vempno | vname |
+--------+-------+
|   7369 | SMITH |
+--------+-------+
1 row in set (0.09 sec)

+--------+-------+
| vempno | vname |
+--------+-------+
|   7499 | ALLEN |
+--------+-------+
1 row in set (0.10 sec)

+--------+-------+
| vempno | vname |
+--------+-------+
|   7521 | WARD  |
+--------+-------+
1 row in set (0.12 sec)

+--------+-------+
| vempno | vname |
+--------+-------+
|   7566 | JONES |
+--------+-------+
1 row in set (0.14 sec)

+--------+--------+
| vempno | vname  |
+--------+--------+
|   7654 | MARTIN |
+--------+--------+
1 row in set (0.15 sec)

+--------+-------+
| vempno | vname |
+--------+-------+
|   7698 | BLAKE |
+--------+-------+
1 row in set (0.16 sec)

+--------+-------+
| vempno | vname |
+--------+-------+
|   7782 | CLARK |
+--------+-------+
1 row in set (0.16 sec)

+--------+-------+
| vempno | vname |
+--------+-------+
|   7788 | SCOTT |
+--------+-------+
1 row in set (0.17 sec)

+--------+-------+
| vempno | vname |
+--------+-------+
|   7839 | KING  |
+--------+-------+
1 row in set (0.18 sec)

+--------+--------+
| vempno | vname  |
+--------+--------+
|   7844 | TURNER |
+--------+--------+
1 row in set (0.19 sec)

+--------+-------+
| vempno | vname |
+--------+-------+
|   7876 | ADAMS |
+--------+-------+
1 row in set (0.20 sec)

+--------+-------+
| vempno | vname |
+--------+-------+
|   7900 | JAMES |
+--------+-------+
1 row in set (0.20 sec)

+--------+-------+
| vempno | vname |
+--------+-------+
|   7902 | FORD  |
+--------+-------+
1 row in set (0.21 sec)

+--------+--------+
| vempno | vname  |
+--------+--------+
|   7934 | MILLER |
+--------+--------+
1 row in set (0.22 sec)

Query OK, 0 rows affected (0.23 sec)

mysql>